# Task仕様書（agents/）ガイド

> **参考**: `docs/SAMPLE/dev/meta-skill-creator/skills/skill-creator/references/skill-structure.md`

---

## 概要

agents/ディレクトリには「Task仕様書」を配置する。
サブエージェント定義（永続人格の定義）**ではない**。

---

## 位置づけ

| 観点 | 説明 |
|------|------|
| Task仕様書 | 役割・入力・出力・制約・参照先を書く |
| 読み込みタイミング | 実行直前に、そのTask分だけまとめて読まれる |
| 重要性 | **軽量に保つ**（Progressive Disclosure） |

---

## Task仕様書テンプレート

```markdown
# Task仕様書：{{Task名}}

## 1. メタ情報

- 名前: {{実在する専門家の名前}}
  > 注記: 思考様式の参照ラベル。本人を名乗らず、方法論のみ適用。
- 推奨モデル: {{opus / sonnet / haiku}}
  > 注記: タスクの複雑さに応じて選択。高度な判断が必要な場合はopus、定型的な処理はhaiku。

## 2. プロフィール

### 2.1 背景

{{このTaskが生まれた背景・文脈}}

### 2.2 目的

{{このTaskが達成すべき目的}}

### 2.3 責務

{{このTaskが担う責務（何をする/しない）}}

## 3. 知識ベース

### 3.1 参考文献

- {{書籍名}} / 著者: {{著者名}} / 適用: {{適用範囲}}

## 4. 実行仕様

### 4.1 思考プロセス

1. {{ステップ1}}
2. {{ステップ2}}
3. {{ステップ3}}

### 4.2 チェックリスト

- [ ] {{チェック項目1}}
- [ ] {{チェック項目2}}

### 4.3 ビジネスルール（制約）

- {{制約1}}
- {{制約2}}

## 5. インターフェース

### 5.1 入力

| 項目 | 型 | 必須 | 説明 |
|------|-----|------|------|
| {{入力1}} | {{型}} | {{必須/任意}} | {{説明}} |

### 5.2 出力

| 項目 | 型 | 説明 |
|------|-----|------|
| {{出力1}} | {{型}} | {{説明}} |
```

---

## 設計原則

### 1. 責務分離

**1 Task = 1 責務**を基本とする。

| すべきこと | 避けるべきこと |
|-----------|---------------|
| 単一の明確な目的 | 複数責務の同居 |
| 入出力の明確化 | 曖昧なスコープ |
| 参照先への導線 | 知識のベタ書き |

### 2. 軽量化

Task仕様書は**軽量に保つ**。詳細知識はreferences/に外部化。

| 軽量化のポイント | 説明 |
|-----------------|------|
| 知識の外部化 | 詳細はreferences/に |
| 参考文献は名前のみ | 内容はreferences/に |
| チェックリストは要点のみ | 詳細手順はreferences/に |

### 3. Progressive Disclosure

Task仕様書は**実行直前に読み込まれる**。
必要な時に必要なTask分だけ読み込むことで、コンテキストを節約。

---

## Big 3スキルのTask設計

### story-to-tasks

| Task | 責務 | 推奨モデル | 入力 | 出力 |
|------|------|-----------|------|------|
| analyze-story | ストーリーの理解 | **opus** | ユーザーストーリー | 目的・スコープ・受入条件 |
| decompose-tasks | タスク分解 | sonnet | 分析結果 | タスクリスト |
| classify-tdd-plan | TDD/PLAN分類 | haiku | タスクリスト | ラベル付きタスクリスト |

### developing

| Task | 責務 | 推奨モデル | 入力 | 出力 |
|------|------|-----------|------|------|
| tdd-write-test | テスト作成（RED） | sonnet | タスク仕様 | 失敗するテスト |
| tdd-implement | 実装（GREEN） | sonnet | テスト | 通る実装 |
| tdd-refactor | リファクタ | **opus** | 実装コード | 改善されたコード |
| plan-implement | UI実装 | sonnet | タスク仕様 | UIコンポーネント |
| plan-verify | 検証 | haiku | UI実装 | 検証結果 |

### feedback

| Task | 責務 | 推奨モデル | 入力 | 出力 |
|------|------|-----------|------|------|
| analyze-changes | 変更分析 | sonnet | git diff | 学習事項 |
| update-design | 仕様書更新 | **opus** | 学習事項 | DESIGN.md更新 |
| detect-patterns | パターン検出 | haiku | 実装履歴 | パターンリスト |
| propose-improvement | 改善提案 | **opus** | パターン | スキル化/ルール化提案 |

### モデル選択の判断基準

| モデル | 使用場面 | 特徴 |
|--------|----------|------|
| **opus** | 高度な判断が必要（要件理解、設計判断、改善提案） | 最高精度、コスト高 |
| **sonnet** | コード生成、定型的な分析 | バランス型 |
| **haiku** | 分類、パターンマッチング、チェックリスト実行 | 高速、低コスト |

---

## Task分割の判断基準

### 分割すべき場合

| 状況 | 理由 |
|------|------|
| 思考ログが肥大する | 分離してコンテキスト節約 |
| フェーズ間で責務が異なる | 責務分離の原則 |
| 並列実行の恩恵を受ける | 効率化 |

### 分割しない場合

| 状況 | 理由 |
|------|------|
| 単純なタスク（ステップが3未満） | オーバーヘッド増加 |
| 入出力が曖昧 | 分割困難 |
| コンテキスト共有が必須 | 分割すると情報が失われる |

---

## 関連リソース

- **構造仕様**: `docs/SAMPLE/dev/meta-skill-creator/skills/skill-creator/references/skill-structure.md`
- **ワークフローパターン**: `docs/SAMPLE/dev/meta-skill-creator/skills/skill-creator/references/workflow-patterns.md`
- **skill-creator assets**: `docs/SAMPLE/dev/meta-skill-creator/skills/skill-creator/assets/agent-task-template.md`
