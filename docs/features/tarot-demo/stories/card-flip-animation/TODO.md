# TODO: カード表示・フリップ演出 (card-flip-animation)

## ストーリー概要

ユーザーとして、カードをタップすると裏から表にめくれるアニメーションを見たい。
占いの神秘的な雰囲気を楽しめるように。

## 受入条件

- [AC-1] カードをタップすると裏から表にめくれるアニメーションが再生される
- [AC-2] アニメーションは3D回転で自然な「めくれ」を表現する
- [AC-3] アニメーション中はカードをタップできない（二重実行防止）
- [AC-4] アニメーション完了後はカードが表面のまま固定される
- [AC-5] レスポンシブデザインで各デバイスサイズに対応

---

## TASK-1: カードフリップロジックの実装

カードのフリップ状態を管理し、アニメーション中の二重実行を防止するロジックを実装する

- [ ] [TDD][RED] useCardFlip フックのテスト作成
- [ ] [TDD][GREEN] useCardFlip フックの実装
- [ ] [TDD][REFACTOR] useCardFlip フックのリファクタリング
- [ ] [TDD][REVIEW] セルフレビュー（過剰適合・抜け道チェック）
- [ ] [TDD][CHECK] lint/format/build

**判定理由**: 状態管理ロジック（isFlipped、isFlipping）とメソッド（startFlip、endFlip）の入出力が明確で、期待値との比較が可能。アサーションで検証できる。

---

## TASK-2: フリップアニメーションCSS実装

CSS 3D Transformを使用したカードフリップアニメーションのスタイルを実装する

- [ ] [E2E][IMPL] TarotCard.module.css にフリップアニメーション実装
- [ ] [E2E][AUTO] agent-browserでアニメーション視覚的検証
- [ ] [E2E][CHECK] lint/format

**判定理由**: CSS 3Dアニメーションの見た目・滑らかさを確認する必要があり、視覚的確認が必須。デザイン仕様との一致が重要。

---

## TASK-3: TarotCardコンポーネント統合

フリップロジックとCSSをTarotCardコンポーネントに統合し、タップイベントでアニメーションを発火させる

- [ ] [E2E][IMPL] TarotCard.tsx にフリップ機能統合
- [ ] [E2E][AUTO] agent-browserでタップ→フリップ動作検証
- [ ] [E2E][CHECK] lint/format/build

**判定理由**: UIコンポーネントの統合で、タップ操作→アニメーション発火→完了の一連の流れをユーザー視点で確認する必要がある。

---

## TASK-4: レスポンシブ対応とアクセシビリティ

各デバイスサイズでのアニメーション調整と、キーボード操作・スクリーンリーダー対応を実装する

- [ ] [E2E][IMPL] レスポンシブCSS、アクセシビリティ属性追加
- [ ] [E2E][AUTO] agent-browserで3ブレイクポイント検証（モバイル/タブレット/デスクトップ）
- [ ] [E2E][AUTO] キーボード操作（Tab、Enter）検証
- [ ] [E2E][CHECK] lint/format/build

**判定理由**: レスポンシブデザインとアクセシビリティは視覚的確認とユーザビリティ検証が必須。各デバイスサイズでの表示確認が必要。

---

## TASK-5: agent-browserによるフリップアニメーション検証

実際のブラウザでカードフリップアニメーションの動作と見た目を検証する

- [ ] [E2E][AUTO] フリップアニメーション全体検証
- [ ] [E2E][AUTO] アニメーション中の二重タップ防止確認
- [ ] [E2E][AUTO] アニメーション完了後の状態確認
- [ ] [E2E][AUTO] 全デバイスサイズでの最終確認

**判定理由**: UI/UXの最終検証で、視覚的確認とユーザー操作フローの確認が必要。

---

## 進捗

- [ ] TASK-1: カードフリップロジックの実装
- [ ] TASK-2: フリップアニメーションCSS実装
- [ ] TASK-3: TarotCardコンポーネント統合
- [ ] TASK-4: レスポンシブ対応とアクセシビリティ
- [ ] TASK-5: agent-browserによるフリップアニメーション検証

## ワークフロー分類サマリー

- **TDD**: 1タスク（状態管理ロジック）
- **E2E**: 4タスク（CSS、UI統合、レスポンシブ、最終検証）
- **TASK**: 0タスク

## 技術的考慮事項

- CSS 3D Transform（rotateY）を使用
- perspective、transform-style: preserve-3d が必要
- アニメーション中の状態管理（useState）
- タッチデバイスでのイベント処理
- パフォーマンス最適化（GPU加速）
- ブラウザ互換性（Safari、Chrome、Firefox）

## 依存関係

```
TASK-1, TASK-2
    ↓
  TASK-3
    ↓
  TASK-4
    ↓
  TASK-5
```
