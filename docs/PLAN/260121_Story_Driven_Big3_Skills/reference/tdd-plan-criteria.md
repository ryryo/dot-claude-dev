# TDD/PLAN 判定基準

## 判定の考え方

LLMがタスク内容を総合的に分析し、以下の観点で [TDD] or [PLAN] を決定する。

## 判定観点

### 1. 入出力の明確性

入力と期待出力が明確に定義できるか？

- **Yes** → TDD向き
- **No**（見た目やUXで判断）→ PLAN向き

### 2. テスト表現性

アサーションで正しさを表現できるか？

- **Yes** → TDD向き
- **No**（視覚的確認が必要）→ PLAN向き

### 3. 変更頻度

仕様は安定しているか？

- **安定** → TDD向き
- **流動的・探索的** → PLAN向き

### 4. レイヤー判定

- **ロジック層**（計算、変換、状態管理）→ TDD
- **プレゼンテーション層**（UI、スタイル）→ PLAN

## 判定早見表

| 基準 | TDD向き | PLAN向き |
|------|---------|----------|
| **仕様の明確性** | 入出力が明確に定義可能 | 見た目やUXで判断 |
| **変更頻度** | 仕様が安定している | 頻繁に変更される |
| **テスト表現性** | アサーションで表現可能 | 視覚的判断が必要 |
| **影響範囲** | ビジネスロジック | プレゼンテーション層 |
| **投資対効果** | テストの価値が長期的 | テストコストが価値を上回る |

## TDD適用推奨

- ビジネスロジック（バリデーション、計算、データ変換）
- カスタムフック・ユーティリティ関数
- 状態管理ロジック（Redux reducer、Zustand store）
- APIクライアント層

## PLAN適用推奨

- UI/UXコンポーネントの見た目
- レイアウト、スタイリング、アニメーション
- 仕様が流動的な探索的開発
- 一度きりの実装（特定プロジェクト固有のページ）

## 具体的な判定例

| タスク | 判定 | 理由 |
|--------|------|------|
| `validateEmail関数の実装` | TDD | 入出力明確、アサーション可能 |
| `useAuthフックの実装` | TDD | 状態遷移が定義可能 |
| `ログインフォームのUI実装` | PLAN | 見た目の確認が必要 |
| `レスポンシブ対応` | PLAN | 視覚的確認が必要 |
| `APIクライアントのエラーハンドリング` | TDD | エラーケースが列挙可能 |
| `アニメーション追加` | PLAN | 動きの確認が必要 |
| `価格計算ロジック` | TDD | 入出力明確、境界値テスト可能 |
| `ダッシュボードレイアウト` | PLAN | 視覚的バランスの確認が必要 |
| `フォームバリデーション` | TDD | ルールが明確、エッジケース列挙可能 |
| `ホバーエフェクト` | PLAN | インタラクションの見た目確認 |

## TODO.md 出力形式

```markdown
### フェーズ2: ユーザー認証機能

#### TDDタスク
- [ ] [TDD][RED] validateEmail のテスト作成
- [ ] [TDD][GREEN] validateEmail の実装
- [ ] [TDD][REFACTOR] validateEmail のリファクタリング

#### PLANタスク
- [ ] [PLAN][IMPL] LoginForm UIコンポーネント実装
- [ ] [PLAN][AUTO] agent-browser自動検証

#### 共通タスク
- [ ] [CHECK] lint/format/build の実行
```

## 覚えておくこと

**UIは目で見て確認。ロジックはテストで確認。**
