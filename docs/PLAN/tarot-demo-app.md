# タロット占いデモアプリ計画書

## 概要

dev:story / dev:developing / dev:feedback スキルの統合テスト用デモプロジェクト。
TDDワークフローとPLANワークフローの両方を検証できる構成。

## 目的

- **スキル検証**: dev:story-to-tasks によるTDD/PLAN分岐の自動判定
- **ワークフロー検証**: TDD（RED→GREEN→REFACTOR）とPLAN（agent-browser検証）の実践
- **フィードバック検証**: dev:feedback によるDESIGN.md蓄積と改善提案

## 技術スタック（想定）

- TypeScript
- React（またはVanilla JS）
- Vitest（テスト）
- CSS Modules / Tailwind

---

## ストーリー一覧

### TDDストーリー（3件）

#### Story 1: デッキ生成・シャッフル

```
ユーザーとして、占いを始めるときに
78枚のタロットカードがシャッフルされた状態で用意されてほしい
それによって、毎回異なる占い結果を得られる
```

**受け入れ条件**:
- [ ] 大アルカナ22枚が含まれる（愚者〜世界）
- [ ] 小アルカナ56枚が含まれる（4スート × 14枚）
- [ ] シャッフル後、重複するカードがない
- [ ] シャッフルのたびに順序が変わる（ランダム性）

**TDDで検証するロジック**:
- `createDeck()`: 78枚のカード配列を生成
- `shuffleDeck(deck)`: Fisher-Yatesシャッフル
- カードの型定義（id, name, suit, number, arcana）

---

#### Story 2: カード抽選ロジック

```
ユーザーとして、「3枚引き」を選んだときに
過去・現在・未来のポジションに異なるカードが配置されてほしい
それによって、時間軸に沿った運勢を知ることができる
```

**受け入れ条件**:
- [ ] 指定枚数（1, 3, 10枚など）のカードを抽選できる
- [ ] 同じカードが複数回選ばれない
- [ ] 各カードに正位置/逆位置がランダムに設定される
- [ ] 各カードにポジション（過去/現在/未来など）が割り当てられる

**TDDで検証するロジック**:
- `drawCards(deck, count)`: N枚のカードを抽選
- `determineOrientation()`: 正位置/逆位置をランダム判定
- `assignPositions(cards, spread)`: スプレッドに応じたポジション割り当て

---

#### Story 3: 運勢メッセージ生成

```
ユーザーとして、引いたカードに応じた
意味と総合的なアドバイスを見たい
それによって、今日の行動指針を得られる
```

**受け入れ条件**:
- [ ] カード×正逆の組み合わせで意味テキストを取得できる
- [ ] ポジションに応じた解釈が付与される
- [ ] 複数カードから総合メッセージを生成できる

**TDDで検証するロジック**:
- `getCardMeaning(card, orientation)`: カードの意味を取得
- `interpretPosition(card, position)`: ポジション別の解釈
- `generateSummary(readings)`: 総合運勢メッセージの生成

---

### PLANストーリー（3件）

#### Story 4: カード表示・フリップ演出

```
ユーザーとして、カードをタップすると
裏から表にめくれるアニメーションを見たい
それによって、占いの神秘的な雰囲気を楽しめる
```

**受け入れ条件**:
- [ ] カードが裏面の状態で表示される
- [ ] タップ/クリックで表面にフリップする
- [ ] フリップアニメーションが滑らかに動作する
- [ ] フリップ後、カード名と画像が表示される

**agent-browserで検証する項目**:
- カード要素の存在確認
- クリック操作でフリップが発生するか
- アニメーション完了後の表示状態

---

#### Story 5: スプレッドレイアウト

```
ユーザーとして、3枚引きのカードが
「過去 - 現在 - 未来」の位置に並んで表示されてほしい
それによって、時間の流れを視覚的に理解できる
```

**受け入れ条件**:
- [ ] 3枚のカードが横並びで表示される
- [ ] 各カードの下にポジション名が表示される
- [ ] モバイル（375px）でも見やすいレイアウト
- [ ] カード間の余白が適切

**agent-browserで検証する項目**:
- デスクトップでの横並び表示
- モバイルサイズでのレスポンシブ対応
- ポジションラベルの表示

---

#### Story 6: 結果画面

```
ユーザーとして、占い結果として
各カードの意味と総合運勢を読みやすく見たい
それによって、占い結果を理解し活用できる
```

**受け入れ条件**:
- [ ] 各カードの名前・画像・意味が表示される
- [ ] 正位置/逆位置が明示される
- [ ] 総合運勢のまとめが表示される
- [ ] 「もう一度占う」ボタンがある

**agent-browserで検証する項目**:
- 結果テキストの表示確認
- 全体のレイアウト・読みやすさ
- 再占いボタンの動作

---

## ディレクトリ構成（想定）

```
tarot-demo/
├── src/
│   ├── domain/
│   │   ├── card.ts          # カードの型定義
│   │   ├── deck.ts          # デッキ生成・シャッフル
│   │   ├── draw.ts          # カード抽選
│   │   └── reading.ts       # 運勢メッセージ
│   ├── data/
│   │   └── meanings.ts      # カードの意味データ
│   ├── components/
│   │   ├── Card/            # カード表示
│   │   ├── Spread/          # スプレッドレイアウト
│   │   └── Result/          # 結果画面
│   └── App.tsx
├── tests/
│   ├── deck.test.ts
│   ├── draw.test.ts
│   └── reading.test.ts
└── DESIGN.md                # 実装で得た知見
```

---

## 実行順序

1. **Story 1-3（TDD）**: ロジック層を先に実装
2. **Story 4-6（PLAN）**: UI層をagent-browserで検証しながら実装
3. **dev:feedback**: 実装完了後、DESIGN.mdに知見を蓄積

---

## 検証ポイント

| スキル | 検証内容 |
|--------|----------|
| dev:story-to-tasks | ストーリーからTDD/PLANラベル付きタスクが正しく生成されるか |
| dev:developing (TDD) | RED→GREEN→REFACTORサイクルが回るか |
| dev:developing (PLAN) | agent-browser検証が正しく動作するか |
| dev:feedback | DESIGN.md更新と改善提案が生成されるか |

---

## 備考

- カード画像はプレースホルダー（色+テキスト）で代用可
- 78枚全ての意味データは最小限（大アルカナのみでも可）
- スプレッドは「3枚引き」のみで十分
