# Transformer スクリプトテンプレート指示

> **読み込み条件**: type === "transformer" の場合
> **対応ランタイム**: Node.js, Python

---

## 目的

データスキーマ変換・マッピング処理を行うスクリプトを生成する。

---

## AIへの実装指示

### 必須機能

1. **スキーママッピング**
   - フィールド名の変換
   - ネスト構造の変換
   - 配列要素の変換

2. **データ変換**
   - 型変換（文字列→数値等）
   - 日付フォーマット変換
   - 値のマッピング（enum変換等）

3. **フィルタリング**
   - 条件に基づくデータ抽出
   - フィールドの選択/除外

4. **集約**
   - データのグループ化
   - 計算フィールドの追加

### 推奨依存関係

| ランタイム | 推奨パッケージ |
|------------|----------------|
| Node.js | lodash, date-fns |
| Python | pandas, python-dateutil |

### 環境変数

- `{{MAPPING_FILE}}`: マッピング定義ファイル

### 引数仕様

| 引数 | 必須 | 説明 |
|------|------|------|
| --input | ○ | 入力データファイル |
| --mapping | ○ | マッピング定義（JSON/ファイル） |
| --output | × | 出力ファイルパス |
| --validate | × | 変換後のバリデーション |

### 出力形式

- 変換後のデータをJSON形式で出力

---

## コード構造の指示

AIは以下の構造でコードを生成してください:

```
1. インポート
   - データ操作ライブラリ
   - 日付処理ライブラリ

2. 設定
   - デフォルトマッピング
   - 終了コード定数

3. ユーティリティ関数
   - loadMapping(): マッピング定義読み込み
   - transformField(): フィールド変換
   - transformRecord(): レコード変換
   - validateResult(): 結果検証

4. メイン処理
   - 引数パース
   - データ読み込み
   - 変換実行
   - 結果出力
```

---

## 品質基準

AIは以下の基準を満たすコードを生成してください:

- [ ] マッピング定義の検証
- [ ] 変換失敗時の詳細なエラー
- [ ] 部分的な変換結果の保存
- [ ] null/undefined の適切な処理
- [ ] 循環参照の検出
