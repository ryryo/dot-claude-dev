# 実行モード選択ガイド

> **読み込み条件**: モード選択の判断に迷った時
> **相対パス**: `references/execution-mode-guide.md`

## 概要

タスクの性質に応じて最適な実行モードを選択するためのガイドライン。

---

## モード比較表

| 観点 | Claude Code | Codex (GPT-5.2) | Claude → Codex |
|------|-------------|-----------------|----------------|
| **ファイル編集** | ✅ 最適 | ❌ 不可 | ⚠️ 結果のみ |
| **Git操作** | ✅ 最適 | ❌ 不可 | ⚠️ Claude側で |
| **コードベース理解** | ✅ 深い | ⚠️ 限定的 | ✅ 深い |
| **独立分析** | ✅ 可能 | ✅ 最適 | ✅ 可能 |
| **別視点** | ❌ 同一 | ✅ 異なる | ✅ 異なる |
| **長文生成** | ⚠️ 制限あり | ✅ 得意 | ✅ 得意 |
| **対話型** | ✅ 最適 | ❌ バッチ | ⚠️ 結果確認 |

---

## 選択フローチャート

```
[タスク分析]
     │
     ▼
Q1: ファイルを直接編集する必要がある？
     │
    Yes ────────────────────────► claude
     │
    No
     │
     ▼
Q2: Gitコミット/ブランチ操作が必要？
     │
    Yes ────────────────────────► claude
     │
    No
     │
     ▼
Q3: 複数ファイルを横断的に理解する必要がある？
     │
    Yes ─┬─ Q3a: 最終的にCodexの処理能力が必要？
         │       │
         │      Yes ────────────► claude-to-codex
         │       │
         │      No ─────────────► claude
     │
    No
     │
     ▼
Q4: 独立した分析/生成タスク？
     │
    Yes ─┬─ Q4a: GPT特有の能力が必要？
         │       │
         │      Yes ────────────► codex
         │       │
         │      No ─────────────► claude or codex
     │
    No
     │
     ▼
Q5: 別の視点での分析が有用？
     │
    Yes ────────────────────────► codex or claude-to-codex
     │
    No
     │
     ▼
デフォルト ─────────────────────► claude
```

---

## モード別詳細

### Claude Code（claude）

#### 最適な用途

| 用途 | 例 |
|------|-----|
| コード編集 | バグ修正、機能追加、リファクタリング |
| Git操作 | コミット、ブランチ作成、マージ |
| 対話型開発 | 段階的な実装、フィードバックループ |
| コードベース分析 | 依存関係調査、影響範囲特定 |
| テスト実行 | ユニットテスト、統合テスト |

#### 強み

- ファイルシステムへの直接アクセス
- Git CLIの完全な操作
- 対話的なフィードバック
- プロジェクト構造の深い理解

#### 弱み

- 単一の視点（Claude）
- 長文生成時のコンテキスト制限

---

### Codex（codex）

#### 最適な用途

| 用途 | 例 |
|------|-----|
| 独立分析 | コードレビュー、アーキテクチャ評価 |
| ドキュメント生成 | README、API仕様書、コメント |
| コード生成 | ボイラープレート、テンプレート |
| 別視点分析 | セカンドオピニオン、代替案提示 |
| 長文生成 | 詳細な説明文、チュートリアル |

#### 強み

- GPT-5.2の処理能力
- Claude と異なる視点
- 長文生成の得意
- バッチ処理に最適

#### 弱み

- ファイル編集不可
- Git操作不可
- コードベースの限定的な理解（コンテキスト共有時を除く）

---

### Claude → Codex 連携（claude-to-codex）

#### 最適な用途

| 用途 | 例 |
|------|-----|
| コンテキスト付き分析 | 既存コードを踏まえた設計提案 |
| 複合タスク | 調査 → 分析 → 提案 |
| 深い理解 + 別視点 | アーキテクチャ見直し |
| 大規模生成 | コンテキストを踏まえた大量ドキュメント |

#### ワークフロー

```
1. Claude Code: コードベース調査・コンテキスト収集
       ↓
2. Claude Code: context.md 生成
       ↓
3. Codex: コンテキストを踏まえたタスク実行
       ↓
4. Claude Code: 結果検証・統合
```

#### 強み

- 両者の強みを活用
- 深いコンテキスト + 別視点
- 大規模タスクに対応

#### 弱み

- 実行時間が長い
- コンテキスト準備のオーバーヘッド

---

## 具体例

### 例1: バグ修正

```
タスク: 「ログイン機能でセッションが切れるバグを修正して」

分析:
- ファイル編集: 必要 ✅
- Git操作: 必要（コミット）✅
- コードベース理解: 必要 ✅

推奨: claude
```

### 例2: コードレビュー

```
タスク: 「このPRのコードレビューをして」

分析:
- ファイル編集: 不要 ❌
- Git操作: 不要 ❌
- 独立分析: 可能 ✅
- 別視点: 有用 ✅

推奨: codex または claude
```

### 例3: アーキテクチャ提案

```
タスク: 「現在のコードベースを踏まえて、マイクロサービス化の提案をして」

分析:
- ファイル編集: 不要 ❌
- コードベース理解: 必要 ✅
- 別視点: 有用 ✅
- 長文生成: 必要 ✅

推奨: claude-to-codex
```

### 例4: READMEの生成

```
タスク: 「プロジェクトのREADMEを生成して」

分析:
- ファイル編集: Claude側で可能
- コードベース理解: 必要 ✅
- 長文生成: 必要 ✅

推奨: claude または claude-to-codex
```

---

## 判断に迷った場合

### デフォルト選択

**迷ったら `claude` を選択**

理由:
1. 対話的に方向修正できる
2. 必要に応じてCodexに切り替え可能
3. ファイル編集が必要になった場合に対応可能

### ユーザーに確認すべき観点

```
1. 「最終的にファイルを編集する必要がありますか？」
2. 「別の視点での分析が欲しいですか？」
3. 「大量のテキスト生成が必要ですか？」
```

---

## 変更履歴

| Version | Date | Changes |
|---------|------|---------|
| 1.0.0 | 2026-01-15 | 初版作成 |
