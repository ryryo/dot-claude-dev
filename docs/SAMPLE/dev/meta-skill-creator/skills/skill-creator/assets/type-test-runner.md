# Test Runner スクリプトテンプレート指示

> **読み込み条件**: type === "test-runner" の場合
> **対応ランタイム**: Node.js, Python, Bash

---

## 目的

テストの実行と結果解析を行うスクリプトを生成する。

---

## AIへの実装指示

### 必須機能

1. **テスト実行**
   - テストフレームワークの呼び出し
   - 特定テストファイル/ディレクトリの指定
   - パターンマッチによるフィルタリング

2. **結果解析**
   - 成功/失敗数の集計
   - 失敗したテストの詳細取得
   - カバレッジ情報の取得（対応している場合）

3. **出力形式**
   - コンソール出力
   - JSON形式での結果出力
   - JUnit XML形式（CI連携用）

### 推奨テストフレームワーク

| ランタイム | 推奨フレームワーク |
|------------|-------------------|
| Node.js | vitest, jest |
| Python | pytest |
| Bash | bats（Bash用） |

### 引数仕様

| 引数 | 必須 | 説明 |
|------|------|------|
| --path | × | テストファイル/ディレクトリ（デフォルト: tests/） |
| --pattern | × | テスト名のフィルタパターン |
| --coverage | × | カバレッジを取得 |
| --output | × | 結果出力先（JSON/XML） |
| --watch | × | ファイル変更監視モード |
| --verbose | × | 詳細出力 |

### 環境変数

- `{{TEST_TIMEOUT}}`: テストタイムアウト（ミリ秒）
- `{{CI}}`: CI環境フラグ

---

## コード構造の指示

AIは以下の構造でコードを生成してください:

```
1. フレームワーク検出
   - 設定ファイルの存在確認
   - 使用フレームワークの特定

2. ユーティリティ関数
   - detectFramework(): フレームワーク検出
   - buildCommand(): テストコマンド構築
   - parseResults(): 結果解析
   - formatOutput(): 出力フォーマット

3. テスト実行
   - コマンド構築
   - 実行
   - 結果取得

4. 結果処理
   - 解析
   - 出力
   - 終了コード決定
```

---

## 品質基準

AIは以下の基準を満たすコードを生成してください:

- [ ] フレームワーク未検出時の適切なエラー
- [ ] 長時間テストのタイムアウト処理
- [ ] 失敗時の詳細情報出力
- [ ] CI環境での適切な出力形式
- [ ] カバレッジ閾値チェック（指定時）
