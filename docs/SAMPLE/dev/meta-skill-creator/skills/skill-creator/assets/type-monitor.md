# Monitor スクリプトテンプレート指示

> **読み込み条件**: type === "monitor" の場合
> **対応ランタイム**: Node.js, Python

---

## 目的

ヘルスチェック・監視処理を行うスクリプトを生成する。

---

## AIへの実装指示

### 必須機能

1. **ヘルスチェック**
   - HTTPエンドポイント監視
   - ポート疎通確認
   - プロセス監視

2. **メトリクス収集**
   - レスポンスタイム計測
   - エラーレート計算
   - リソース使用率

3. **アラート**
   - 閾値に基づくアラート発火
   - 通知送信（Webhook/メール）
   - エスカレーション

4. **レポート**
   - 監視結果の記録
   - サマリーレポート生成

### 推奨依存関係

| ランタイム | 推奨パッケージ |
|------------|----------------|
| Node.js | 組み込みfetch, prom-client |
| Python | httpx, psutil |

### 環境変数

- `{{MONITOR_TARGETS}}`: 監視対象リスト（JSON）
- `{{ALERT_WEBHOOK}}`: アラート通知先
- `{{CHECK_INTERVAL}}`: チェック間隔（秒）

### 引数仕様

| 引数 | 必須 | 説明 |
|------|------|------|
| --target | ○ | 監視対象URL/ホスト |
| --type | × | チェックタイプ（http/tcp/process） |
| --interval | × | チェック間隔 |
| --timeout | × | タイムアウト |
| --alert | × | アラート閾値 |

### 出力形式

- 監視結果をJSON形式で出力

---

## コード構造の指示

AIは以下の構造でコードを生成してください:

```
1. インポート
   - HTTPクライアント
   - 通知ライブラリ

2. 設定
   - デフォルト閾値
   - 終了コード定数

3. ユーティリティ関数
   - checkHttp(): HTTPチェック
   - checkTcp(): TCP疎通確認
   - checkProcess(): プロセス確認
   - sendAlert(): アラート送信
   - recordResult(): 結果記録

4. メイン処理
   - 引数パース
   - チェック実行
   - 結果評価
   - アラート判定
   - 結果出力
```

---

## 品質基準

AIは以下の基準を満たすコードを生成してください:

- [ ] 適切なタイムアウト設定
- [ ] フラッピング防止
- [ ] 履歴データの保持
- [ ] 複数ターゲットの並列チェック
- [ ] SSL証明書の検証
