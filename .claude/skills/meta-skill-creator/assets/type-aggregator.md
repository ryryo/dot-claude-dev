# Aggregator スクリプトテンプレート指示

> **読み込み条件**: type === "aggregator" の場合
> **対応ランタイム**: Python, Node.js

---

## 目的

データ集約・統計処理を行うスクリプトを生成する。

---

## AIへの実装指示

### 必須機能

1. **データ集約**
   - グループ化（GROUP BY相当）
   - 集計関数（SUM, AVG, COUNT, MIN, MAX）
   - ピボット処理

2. **統計計算**
   - 基本統計量の算出
   - 分布分析
   - 時系列集計

3. **フィルタリング**
   - 集計前フィルタ
   - 集計後フィルタ（HAVING相当）

4. **出力**
   - 集計結果のフォーマット
   - レポート形式での出力

### 推奨依存関係

| ランタイム | 推奨パッケージ |
|------------|----------------|
| Python | pandas, numpy |
| Node.js | lodash, simple-statistics |

### 環境変数

- `{{OUTPUT_FORMAT}}`: デフォルト出力形式

### 引数仕様

| 引数 | 必須 | 説明 |
|------|------|------|
| --input | ○ | 入力データファイル |
| --group-by | ○ | グループ化キー |
| --aggregate | ○ | 集計定義（JSON形式） |
| --output | × | 出力ファイルパス |
| --format | × | 出力形式（json/csv/table） |

### 出力形式

- 集計結果を指定形式で出力

---

## コード構造の指示

AIは以下の構造でコードを生成してください:

```
1. インポート
   - データ操作ライブラリ
   - 統計ライブラリ

2. 設定
   - サポート集計関数
   - 終了コード定数

3. ユーティリティ関数
   - loadData(): データ読み込み
   - groupData(): グループ化
   - aggregate(): 集計実行
   - formatResult(): 結果整形

4. メイン処理
   - 引数パース
   - データ読み込み
   - 集計実行
   - 結果出力
```

---

## 品質基準

AIは以下の基準を満たすコードを生成してください:

- [ ] 大量データの効率的な処理
- [ ] 数値精度の保持
- [ ] 欠損値の適切な処理
- [ ] グループ化キーのソート対応
- [ ] メモリ使用量の最適化
